# blur-project
#### 기간 : 2023. 10. 16 ~ 2023. 10. 27

# 아이디어 배경
- 평소 길을 걷다가 사진이나 영상 촬영하는 사람들의 카메라에 본인의 얼굴이 나올까 봐 걱정했던 경험이 있음
- 허가 없이 찍힌 타인의 얼굴이 그대로 sns에 업로드 되어 문제가 됨
- 영상 크리에이터나 sns에 사진을 올릴 때 일일이 다른 사람의 얼굴을 편집으로 지우느라 시간이 소요

# 구현 내용
- 영상이나 이미지를 업로드 했을 때 등록된 사용자 이외에 모르는 얼굴이 감지되면 블러 처리


# 학습
<img src="https://github.com/k2520624/blur-project/assets/75367132/80668986-4c8d-409b-9a95-12ded8c0aeb0" width="640" height="480"/>

#### 이미지 전처리
- 수집한 이미지를 yolo 모델에 사용할 수 있게 전처리 진행
- 이미지를 RGB 형식으로 변경하고, 차원을 조정하여 PyTorch의 텐서로 변환
- 픽셀 값을 0부터 1 사이로 정규화

#### 얼굴 검출
- 전처리된 이미지를 YOLOv5-face 모델을 기반으로 얼굴을 예측함
- 예측 결과에 대해 지정된 confidence threshold 와 IoU threshold를 기반으로 non-maximum suppression(NMS)를 적용
- NMS를 통해 얻은 얼굴 바운딩 박스 좌표를 반환

#### 특징점 검출
- resnet100 모델을 사용해 얼굴의 특징점을 검출
- 특징 벡터를 정규화 한후 numpy 형태로 변환

#### 저장
- numpy 라이브러리의 np.savez_compressed 함수를 사용하여 얼굴 특징 벡터와 해당하는 이미지 이름을 압축된 numpy 배열 형식으로 저장(.npz)

# 실행

<img src="https://github.com/k2520624/blur-project/assets/75367132/09a7572e-7c92-4c97-8258-892d64127c8b" width="640" height="480"/>

- 학습과 같은 방식으로 영상이나 이미지에서 검출되는 모든 얼굴을 인식하고 특징점을 검출
- 이미지에서 검출된 특징과 저장된 특징을 비교하여 유사도가 일정 기준치를 넘어가지 못하면 블러처리


# 결과
<img src="https://github.com/k2520624/blur-project/assets/75367132/75334a71-3811-4600-90bc-002e68da9ef2" width="940" height="480"/>

- 이미지나 영상을 시스템에 업로드 했을 때 등록된 사용자 외에는 unknown으로 사용자의 이름이 저장되고 unknown이 표시된 얼굴을 블러 처리
- 해당 사진은 비쥬얼라이징을 통해 시각적으로 설명하기 위한 것으로 실제로는 바운딩 박스와 이름이 제거된 상태로 결과가 반환됨

# 특이점
- 사용했던 하드웨어 스펙이 좋지 않아서 실시간으로는 진행하지 못함
- 스펙이 갖춰진다면 실시간으로 완성해보고 싶음

